<Window x:Class="RemoteFileManager.Client.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Remote File Manager"
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="35"/>
        </Grid.RowDefinitions>

        <!-- Top Bar -->
        <Border Background="#673AB7" Grid.Row="0">
            <DockPanel Margin="20,0">
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center">
                    <TextBlock Text="🗂️" FontSize="28" Margin="0,0,10,0" Foreground="White"/>
                    <TextBlock Text="Remote File Manager" 
                              FontSize="20"
                              FontWeight="Bold"
                              VerticalAlignment="Center"
                              Foreground="White"/>
                </StackPanel>

                <TextBlock Text="{Binding Username, StringFormat='👤 {0}'}" 
                          FontSize="14"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Right"
                          DockPanel.Dock="Right"
                          Foreground="White"/>
            </DockPanel>
        </Border>

        <!-- Toolbar -->
        <Border Background="White" Grid.Row="1" BorderBrush="#DDD" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" Margin="10,0">

                <!-- Navigation -->
                <Button Content="⬆️ Up"
                       Command="{Binding NavigateUpCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="Transparent"
                       BorderThickness="1"
                       BorderBrush="#DDD"
                       Cursor="Hand"/>

                <Button Content="🔄 Refresh"
                       Command="{Binding RefreshCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="Transparent"
                       BorderThickness="1"
                       BorderBrush="#DDD"
                       Cursor="Hand"/>

                <Rectangle Width="1" Fill="#DDD" Margin="10,5"/>

                <!-- File Operations -->
                <Button Content="📁 New Folder"
                       Command="{Binding CreateFolderCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="#673AB7"
                       Foreground="White"
                       BorderThickness="0"
                       Cursor="Hand"/>

                <Button Content="⬆️ Upload"
                       Command="{Binding UploadFileCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="#4CAF50"
                       Foreground="White"
                       BorderThickness="0"
                       Cursor="Hand"/>

                <Button Content="⬇️ Download"
                       Command="{Binding DownloadFileCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="#2196F3"
                       Foreground="White"
                       BorderThickness="0"
                       Cursor="Hand"
                       IsEnabled="{Binding SelectedFile, Converter={StaticResource NotNullToBooleanConverter}}"/>

                <Button Content="✏️"
                       Command="{Binding RenameFileCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="Transparent"
                       BorderThickness="1"
                       BorderBrush="#DDD"
                       Cursor="Hand"
                       ToolTip="Rename"
                       IsEnabled="{Binding SelectedFile, Converter={StaticResource NotNullToBooleanConverter}}"/>

                <Button Content="🗑️"
                       Command="{Binding DeleteFileCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="Transparent"
                       BorderThickness="1"
                       BorderBrush="#DDD"
                       Foreground="Red"
                       Cursor="Hand"
                       ToolTip="Delete"
                       IsEnabled="{Binding SelectedFile, Converter={StaticResource NotNullToBooleanConverter}}"/>

                <Rectangle Width="1" Fill="#DDD" Margin="10,5"/>

                <!-- Search -->
                <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                        Width="200"
                        Margin="5,0"
                        Padding="8"
                        BorderBrush="#DDD"
                        BorderThickness="1">
                    <TextBox.InputBindings>
                        <KeyBinding Key="Enter" Command="{Binding SearchFilesCommand}"/>
                    </TextBox.InputBindings>
                </TextBox>

                <Button Content="🔍"
                       Command="{Binding SearchFilesCommand}"
                       Margin="5,0"
                       Padding="10,5"
                       Background="Transparent"
                       BorderThickness="1"
                       BorderBrush="#DDD"
                       Cursor="Hand"/>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <Border Grid.Row="2" Background="White" Margin="10" BorderBrush="#DDD" BorderThickness="1">
            <Grid>
                <!-- Current Path -->
                <TextBlock Text="{Binding CurrentPath, StringFormat='📂 {0}'}"
                          FontSize="12"
                          Margin="15,10"
                          VerticalAlignment="Top"
                          Foreground="#666"
                          Background="White"/>

                <!-- File DataGrid -->
                <DataGrid ItemsSource="{Binding Files}"
                         SelectedItem="{Binding SelectedFile}"
                         AutoGenerateColumns="False"
                         CanUserAddRows="False"
                         CanUserDeleteRows="False"
                         IsReadOnly="True"
                         SelectionMode="Single"
                         GridLinesVisibility="Horizontal"
                         HeadersVisibility="Column"
                         Margin="0,40,0,0"
                         BorderThickness="0"
                         Background="White">

                    <DataGrid.InputBindings>
                        <MouseBinding Gesture="LeftDoubleClick" 
                                    Command="{Binding OpenFileCommand}"
                                    CommandParameter="{Binding SelectedFile}"/>
                    </DataGrid.InputBindings>

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Icon" Binding="{Binding Icon}" Width="60"/>
                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                        <DataGridTextColumn Header="Size" Binding="{Binding SizeFormatted}" Width="100"/>
                        <DataGridTextColumn Header="Modified" Binding="{Binding ModifiedDate, StringFormat='yyyy-MM-dd HH:mm'}" Width="150"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding Extension}" Width="80"/>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Loading Overlay -->
                <Grid Background="#80000000" 
                     Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <ProgressBar IsIndeterminate="True"
                                   Width="100" Height="100"
                                   Style="{StaticResource MaterialDesignCircularProgressBar}"/>
                        <TextBlock Text="Loading..." 
                                 Foreground="White"
                                 FontSize="16"
                                 Margin="0,20,0,0"
                                 HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Status Bar -->
        <Border Background="#F5F5F5" Grid.Row="3" BorderBrush="#DDD" BorderThickness="0,1,0,0">
            <Grid Margin="10,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status Message -->
                <TextBlock Text="{Binding StatusMessage}" 
                          VerticalAlignment="Center"
                          FontSize="12"
                          Grid.Column="0"/>

                <!-- Progress -->
                <StackPanel Orientation="Horizontal" Grid.Column="1">

                    <!-- Upload Progress -->
                    <StackPanel Orientation="Horizontal" 
                               Visibility="{Binding IsUploading, Converter={StaticResource BoolToVis}}"
                               Margin="0,0,20,0">
                        <TextBlock Text="⬆️" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ProgressBar Value="{Binding UploadProgress}" 
                                    Width="150" 
                                    Height="15"
                                    VerticalAlignment="Center"
                                    Minimum="0" Maximum="100"/>
                        <TextBlock Text="{Binding UploadProgress, StringFormat='{}{0}%'}" 
                                  Margin="5,0,0,0"
                                  FontSize="11"
                                  VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Download Progress -->
                    <StackPanel Orientation="Horizontal" 
                               Visibility="{Binding IsDownloading, Converter={StaticResource BoolToVis}}">
                        <TextBlock Text="⬇️" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ProgressBar Value="{Binding DownloadProgress}" 
                                    Width="150" 
                                    Height="15"
                                    VerticalAlignment="Center"
                                    Minimum="0" Maximum="100"/>
                        <TextBlock Text="{Binding DownloadProgress, StringFormat='{}{0}%'}" 
                                  Margin="5,0,0,0"
                                  FontSize="11"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>